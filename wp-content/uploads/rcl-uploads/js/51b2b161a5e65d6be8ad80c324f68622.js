(function($){ var LkMenu = $('#lk-menu'); var typeButton = $('#rcl-office'); var RclOverlay = $('#rcl-overlay'); function moveMenu() { LkMenu.append($('#sunshine_ext_menu ul').html()); $('#lk-menu .hideshow').remove(); $('#sunshine_ext_menu').remove(); } function closeExtMenu(){ if (RclOverlay.hasClass('sunshine_mbl_menu')){ RclOverlay.fadeOut(100).removeClass('sunshine_mbl_menu'); } $('#sunshine_ext_menu').removeClass('bounce').css({'top' : '','right' : ''}); } if (typeButton.hasClass('vertical-menu')){ if ($(window).width() <= 768) { typeButton.removeClass('vertical-menu').addClass('horizontal-menu'); alignMenu(); } $(window).resize(function() { if ($(window).width() <= 768) { typeButton.removeClass('vertical-menu').addClass('horizontal-menu'); closeExtMenu(); moveMenu(); alignMenu(); } else { typeButton.removeClass('horizontal-menu').addClass('vertical-menu'); closeExtMenu(); moveMenu(); } }); } else if (typeButton.hasClass('horizontal-menu')){ alignMenu(); $(window).resize(function() { closeExtMenu(); moveMenu(); alignMenu(); }); } function menuPosition(){ var hUpMenu = LkMenu.offset().top + 2; $('#sunshine_ext_menu').css({'top' : hUpMenu}); var wRightMenu = ($(window).width() - (LkMenu.offset().left + LkMenu.outerWidth())) - 100; if (wRightMenu > 10) { $('#sunshine_ext_menu').css({'right' : wRightMenu}); } } function alignMenu() { var mw = LkMenu.outerWidth() - 30; var menuhtml = ''; var totalWidth = 0; $.each(LkMenu.children('.rcl-tab-button'), function() { totalWidth += $(this).children().outerWidth(true); if (mw < totalWidth) { menuhtml += $('<div>').append($(this).clone()).html(); $(this).remove(); } }); LkMenu.append( '<span style="position:absolute;" class="rcl-tab-butt hideshow">' + '<a class="recall-button block_button bars" ><i class="fa fa-bars"></i></a>' + '</span>' ); $('body').append( '<div id="sunshine_ext_menu"><ul>' + menuhtml + '</ul></div>' ); var hideshow = $('#lk-menu .rcl-tab-butt.hideshow'); if (menuhtml == '') { hideshow.hide(); } else { hideshow.show(); } $('#lk-menu .hideshow').on('click', function () { RclOverlay.fadeToggle(100).toggleClass('sunshine_mbl_menu'); menuPosition(); $('#sunshine_ext_menu').toggleClass('bounce', 100); }); RclOverlay.on('click', function () { closeExtMenu(); }); $('#sunshine_ext_menu').on('click', function () { closeExtMenu(); }); } })(jQuery); 